# check one where both alleles are missing

cat JKP1397.ref_choices.txt | grep rs118019256_chr1_119930443_A_G_A

"""
	AATTCCAATGCCATATGGTT	rs118019256_chr1_119930443_A_G_A	1
	ACTGACCATTTAATGTCACT	rs118019256_chr1_119930443_A_G_A	1
	ATAGACAAACCATAGATAAT	rs118019256_chr1_119930443_A_G_A	1
	ATCGCCAAACCATCAATAAT	rs118019256_chr1_119930443_A_G_A	1
	ATCGCTTGATATCTGCTACT	rs118019256_chr1_119930443_A_G_A	1
	CAGTGTGAGGTACTGGGTAA	rs118019256_chr1_119930443_A_G_A	1
	CCAGTACATAATGGCGTGGC	rs118019256_chr1_119930443_A_G_A	1
	CTAAGCACTTTGTCCATCCC	rs118019256_chr1_119930443_A_G_A	1
	GAGCGGAGTGATTTGATTCG	rs118019256_chr1_119930443_A_G_A	1
	GCGTTGCTGTGTTCAGTGTT	rs118019256_chr1_119930443_A_G_A	1
	GGGCGGTTGTCGGCGTTGCT	rs118019256_chr1_119930443_A_G_A	1
	TCAATCCCAAATGTCGTATT	rs118019256_chr1_119930443_A_G_A	1
	TTAGTAGTGGCTGTGCGCCA	rs118019256_chr1_119930443_A_G_A	1
	TTCTCTTTAGGCATATAGTA	rs118019256_chr1_119930443_A_G_A	1
	TTGGTCAGTTGTAATAGCAG	rs118019256_chr1_119930443_A_G_A	1
	TTTATAACGTATGGCAACTA	rs118019256_chr1_119930443_A_G_A	1
"""

# pull out individual bam for one of the above barcodes
nm=240219check2;
bc=AATTCCAATGCCATATGGTT;
extract_specific_read_groups \
--tag_field BC \
--out_single_bam ../../202402_sa-troubleshoot/spotchecks/${nm}.bam \
--bam_chunk_table sa2/JKP1397.bam_chunks.txt \
--barcode ${bc} \
--ref_fa /nfs/turbo/parker-kitzman/refs/20240114_t1d-t2d-oligos.fasta

samtools sort -n -O bam ../../202402_sa-troubleshoot/spotchecks/${nm}.bam > ../../202402_sa-troubleshoot/spotchecks/${nm}.readsort.bam

samtools view -f 0x40 ../../202402_sa-troubleshoot/spotchecks/${nm}.readsort.bam|less
# this getting mapped to several things

samtools view -f 0x40 ../../202402_sa-troubleshoot/spotchecks/${nm}.readsort.bam | cut -f3,6 | sort | uniq -c | sort -k1,1n

"""
	1 rs56083426_chr15_38606558_G_A_A	7S34M95S
	1 rs9996906_chr4_6309946_C_T_A	114M1D21M
	8 rs118019256_chr1_119930443_A_G_A	44M91S
	12 rs118019256_chr1_119930443_A_G_A	44M92S
"""


# check to see if this one is in the tagged oligo pool?

cat Pool3A.ref_choices.txt | grep rs118019256_chr1_119930443_A_G_A

"""
	AAAGGCATATGTGCATTCCG	rs118019256_chr1_119930443_A_G_A	1
	AAAGTTGTGAGCGCCGCTTA	rs118019256_chr1_119930443_A_G_A	1
	AACTTCGGATTATCAGTGAT	rs118019256_chr1_119930443_A_G_A	1
	AAGTTTGTAAGGATTCAGGA	rs118019256_chr1_119930443_A_G_A	1
	AAGTTTGTTGCTTAGGTCCT	rs118019256_chr1_119930443_A_G_A	1
	AATAGTCATAGTTATCTATG	rs118019256_chr1_119930443_A_G_A	1
	AATCCTGTTCTTGACCCGCA	rs118019256_chr1_119930443_A_G_A	1
	AATGTGTTTGTTATTAATGC	rs118019256_chr1_119930443_A_G_A	1
	AATTAGATCCCTCGAGGTAC	rs118019256_chr1_119930443_A_G_A	1
	AATTTTTTTAACGGTGCGAT	rs118019256_chr1_119930443_A_G_A	1
	ACAACCTTGCTTGACGGTGG	rs118019256_chr1_119930443_A_G_A	1
	ACAGGATCCGGTCGAAGGTT	rs118019256_chr1_119930443_A_G_A	1
	ACATGAGAGGGCAGATATAC	rs118019256_chr1_119930443_A_G_A	1
	AGCTCGTCTTCGTGTATTGT	rs118019256_chr1_119930443_A_G_A	1
	AGGTCCTCGTCTTAACTGGT	rs118019256_chr1_119930443_A_G_A	1
	AGGTCGCAGTCCCCTACATA	rs118019256_chr1_119930443_A_G_A	1
	AGTGACCTGCTAATAATGTA	rs118019256_chr1_119930443_A_G_A	1
	ATCCAAACGGAAGGGAGCGA	rs118019256_chr1_119930443_A_G_A	1
	ATGAATGTGGTCCCGTTTGC	rs118019256_chr1_119930443_A_G_A	1
	ATGACGCGGGAATATTAGTT	rs118019256_chr1_119930443_A_G_A	1
	ATGCTAGATGTAGTTCAGCT	rs118019256_chr1_119930443_A_G_A	1
	ATGGGCACGTGAACCATGTG	rs118019256_chr1_119930443_A_G_A	1
	ATGTGATGTTTAGTTCTATA	rs118019256_chr1_119930443_A_G_A	1
	ATTGAACGACCCAATCTTCT	rs118019256_chr1_119930443_A_G_A	1
	ATTTTTGTAGTTCTGAACAT	rs118019256_chr1_119930443_A_G_A	1
	CAAATGTCAGGTGAGCATTA	rs118019256_chr1_119930443_A_G_A	1
	CAATTCTCACCATTTTATTC	rs118019256_chr1_119930443_A_G_A	1
	CACCACGAAACAGGGTCGAG	rs118019256_chr1_119930443_A_G_A	1
	CACTACCGGTATCGCTCACG	rs118019256_chr1_119930443_A_G_A	1
	CAGATAAGAACACAATGGTG	rs118019256_chr1_119930443_A_G_A	1
	CAGGCCTAGATAAGGTTGTG	rs118019256_chr1_119930443_A_G_A	1
	CAGTTGTTCAAGAGTACATT	rs118019256_chr1_119930443_A_G_A	1
	CATACTGTACGCTGTTGCGT	rs118019256_chr1_119930443_A_G_A	1
	CATATGGGTATAAGAGTTCC	rs118019256_chr1_119930443_A_G_A	1
	CATGCATGCTACTCTCGAAG	rs118019256_chr1_119930443_A_G_A	1
	CCAACGTTGGGCGTCGGTTG	rs118019256_chr1_119930443_A_G_A	1
	CCATGTTGCTAGAAATGTTC	rs118019256_chr1_119930443_A_G_A	1
	CCGTCTGCGTCAACAGGGCC	rs118019256_chr1_119930443_A_G_A	1
	CCTGACGCTCATCGATGACA	rs118019256_chr1_119930443_A_G_A	1
	CCTTGTAGTGCAAGATAAAC	rs118019256_chr1_119930443_A_G_A	1
	CGAACAAACGAATTCTAGGC	rs118019256_chr1_119930443_A_G_A	1
	CGTAAACAAAGAGATGAAGA	rs118019256_chr1_119930443_A_G_A	1
	CTCCTCTCAATACACTTCAT	rs118019256_chr1_119930443_A_G_A	1
	CTGAAGTGTCATCGATCTTG	rs118019256_chr1_119930443_A_G_A	1
	CTGACCAGGGGCTTCAGAGC	rs118019256_chr1_119930443_A_G_A	1
	CTGCCTCGTTACCACTTTCA	rs118019256_chr1_119930443_A_G_A	1
	CTGGTCGTAGTTCCTCGTGG	rs118019256_chr1_119930443_A_G_A	1
	GAATGTGACTAAGCTTTTAA	rs118019256_chr1_119930443_A_G_A	1
	GACTACCGGGACTACTGCAT	rs118019256_chr1_119930443_A_G_A	1
	GACTCTTGCAGTCACCCTTA	rs118019256_chr1_119930443_A_G_A	1
	GAGGGTTGTCTTTCTGGTGT	rs118019256_chr1_119930443_A_G_A	1
	GATGCTGGGTTACTCTTGGA	rs118019256_chr1_119930443_A_G_A	1
	GCAAGGTGTCCGTCTGGGAA	rs118019256_chr1_119930443_A_G_A	1
	GCAATGATTTAAGGAAGCAA	rs118019256_chr1_119930443_A_G_A	1
	GCACGAGGTATTAGTTCATT	rs118019256_chr1_119930443_A_G_A	1
	GCTGATTGTGAGTTATCACG	rs118019256_chr1_119930443_A_G_A	1
	GGAACGGCTGGAATTGTAGA	rs118019256_chr1_119930443_A_G_A	1
	GGAAGATTGTGTTTTATCTT	rs118019256_chr1_119930443_A_G_A	1
	GGACTAGAGGGGGTCCTTTC	rs118019256_chr1_119930443_A_G_A	1
	GGCCAGAAATTGCCGTGGGA	rs118019256_chr1_119930443_A_G_A	1
	GGGGGCAGGTTGTGGTGTTG	rs118019256_chr1_119930443_A_G_A	1
	GGTGCGTTCGGGTGTAAGAG	rs118019256_chr1_119930443_A_G_A	1
	GTATGAATATAGTGCATGAC	rs118019256_chr1_119930443_A_G_A	1
	GTATTAGTATTCTGAAGTTT	rs118019256_chr1_119930443_A_G_A	1
	GTCATAATGGTATGCAACTG	rs118019256_chr1_119930443_A_G_A	1
	GTGATTAGTGCTAGAATGCC	rs118019256_chr1_119930443_A_G_A	1
	GTGCGCCAATTGGATTTAAA	rs118019256_chr1_119930443_A_G_A	1
	GTGTGTGTTGGTGTTTTGGG	rs118019256_chr1_119930443_A_G_A	1
	GTTCGATCGACCGAATACTG	rs118019256_chr1_119930443_A_G_A	1
	GTTGACCAGAATAAGTGTAA	rs118019256_chr1_119930443_A_G_A	1
	GTTGTCATCTGTAAATGGTT	rs118019256_chr1_119930443_A_G_A	1
	GTTTATAACGACATCTCGTA	rs118019256_chr1_119930443_A_G_A	1
	GTTTTGTTGCCATCCAGACA	rs118019256_chr1_119930443_A_G_A	1
	TAATCTAGTCGTAGGGTCCT	rs118019256_chr1_119930443_A_G_A	1
	TACAAATATCTATATTTGTC	rs118019256_chr1_119930443_A_G_A	1
	TACAATCTAGCGTTTTCTCA	rs118019256_chr1_119930443_A_G_A	1
	TACCATTCTGCTGACCTTAA	rs118019256_chr1_119930443_A_G_A	1
	TACCTATTGTCTTAAGTGGC	rs118019256_chr1_119930443_A_G_A	1
	TACTGACGTCTAGGACCATG	rs118019256_chr1_119930443_A_G_A	1
	TATCAGTACAATACGGGTCC	rs118019256_chr1_119930443_A_G_A	1
	TCACTAATAAGCATGTATAC	rs118019256_chr1_119930443_A_G_A	1
	TCATAGCGGTGGTGTCATCG	rs118019256_chr1_119930443_A_G_A	1
	TCATATGCCCTTGCCTCCCT	rs118019256_chr1_119930443_A_G_A	1
	TCATCCGGCAAACCATCTGG	rs118019256_chr1_119930443_A_G_A	1
	TCGCCTGCAAGGGCGAACTA	rs118019256_chr1_119930443_A_G_A	1
	TCGTGTGGTCGTCCAAGGGA	rs118019256_chr1_119930443_A_G_A	1
	TCTTTCCGCCTGGCACTATA	rs118019256_chr1_119930443_A_G_A	1
	TGGGATGATCTCGGTACCGG	rs118019256_chr1_119930443_A_G_A	1
	TGGTATTTCAATCTGGATCG	rs118019256_chr1_119930443_A_G_A	1
	TGTCCTCTACTCAAGTGTGA	rs118019256_chr1_119930443_A_G_A	1
	TGTGGATCAAGTATGCGGAA	rs118019256_chr1_119930443_A_G_A	1
	TGTGGGGTGTACACTACGCT	rs118019256_chr1_119930443_A_G_A	1
	TTAAATGAGGTGGTACCACG	rs118019256_chr1_119930443_A_G_A	1
	TTAGTTCTATTGATAATACA	rs118019256_chr1_119930443_A_G_A	1
	TTATCTTGATGTAATAGTTA	rs118019256_chr1_119930443_A_G_A	1
	TTCGACTATATTGTACTTTT	rs118019256_chr1_119930443_A_G_A	1
	TTCTCTGATTGTAAGTACCG	rs118019256_chr1_119930443_A_G_A	1
	TTCTTTACTCTATCTTTAAC	rs118019256_chr1_119930443_A_G_A	1
	TTGAATTGGACATTTACTCT	rs118019256_chr1_119930443_A_G_A	1
	TTGCAGACTTTCTGGTGTTG	rs118019256_chr1_119930443_A_G_A	1
	TTGTCGTTTGGGACGACCTC	rs118019256_chr1_119930443_A_G_A	1
	TTGTTCTGTTACTCGTCCAT	rs118019256_chr1_119930443_A_G_A	1
	TTTCTCAAGCAGACGCCCTT	rs118019256_chr1_119930443_A_G_A	1
	TTTGACCAGGTCTGATTGAC	rs118019256_chr1_119930443_A_G_A	1
	TTTTGAAGCCCTGGCGACGC	rs118019256_chr1_119930443_A_G_A	1
	TTTTTTATTCCTTTATAACT	rs118019256_chr1_119930443_A_G_A	1
"""

# yes...a lot....
# now check tagged oligo pool data

nm=240219check2b;
bc=AAAGGCATATGTGCATTCCG;
extract_specific_read_groups \
--tag_field BC \
--out_single_bam ../202402_sa-troubleshoot/spotchecks/${nm}.bam \
--bam_chunk_table sa2/Pool3A.bam_chunks.txt \
--barcode ${bc} \
--ref_fa /nfs/turbo/parker-kitzman/refs/20240114_t1d-t2d-oligos.fasta

samtools sort -n -O bam ../202402_sa-troubleshoot/spotchecks/${nm}.bam > ../202402_sa-troubleshoot/spotchecks/${nm}.readsort.bam

samtools view -f 0x40 ../202402_sa-troubleshoot/spotchecks/${nm}.readsort.bam|less
# only one read, but mapped to correct ref

samtools view -f 0x40 ../202402_sa-troubleshoot/spotchecks/${nm}.readsort.bam | cut -f3,6 | sort | uniq -c | sort -k1,1n

"""
	1 rs118019256_chr1_119930443_A_G_A	12S52M68S
"""

